<mxfile host="app.diagrams.net" modified="2022-02-14T08:56:42.111Z" agent="5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/98.0.4758.80 Safari/537.36" etag="qACMwGa6_ov40R3vqDsW" version="16.5.6" type="github">
  <diagram id="SGd1aUE3qWEg3dzMmrBl" name="第 1 页">
    <mxGraphModel dx="1426" dy="1995" grid="1" gridSize="10" guides="1" tooltips="1" connect="1" arrows="1" fold="1" page="1" pageScale="1" pageWidth="827" pageHeight="1169" math="0" shadow="0">
      <root>
        <mxCell id="0" />
        <mxCell id="1" parent="0" />
        <mxCell id="pypAnUREyRbXbRG19NKG-3" value="" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;" parent="1" source="pypAnUREyRbXbRG19NKG-1" target="pypAnUREyRbXbRG19NKG-2" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="pypAnUREyRbXbRG19NKG-1" value="开始" style="strokeWidth=2;html=1;shape=mxgraph.flowchart.terminator;whiteSpace=wrap;fillColor=#f8cecc;strokeColor=#b85450;" parent="1" vertex="1">
          <mxGeometry x="85" y="20" width="70" height="40" as="geometry" />
        </mxCell>
        <mxCell id="pypAnUREyRbXbRG19NKG-5" value="" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;" parent="1" source="pypAnUREyRbXbRG19NKG-2" target="pypAnUREyRbXbRG19NKG-4" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="pypAnUREyRbXbRG19NKG-2" value="执行分区副本重分配脚本" style="whiteSpace=wrap;html=1;fillColor=#0050ef;strokeColor=#001DBC;strokeWidth=2;fontColor=#ffffff;" parent="1" vertex="1">
          <mxGeometry x="80" y="90" width="80" height="40" as="geometry" />
        </mxCell>
        <mxCell id="pypAnUREyRbXbRG19NKG-7" value="" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;" parent="1" source="pypAnUREyRbXbRG19NKG-4" target="pypAnUREyRbXbRG19NKG-6" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="pypAnUREyRbXbRG19NKG-4" value="解析参数并校验数据" style="whiteSpace=wrap;html=1;fillColor=#0050ef;strokeColor=#001DBC;strokeWidth=2;fontColor=#ffffff;" parent="1" vertex="1">
          <mxGeometry x="80" y="170" width="80" height="40" as="geometry" />
        </mxCell>
        <mxCell id="pypAnUREyRbXbRG19NKG-9" value="" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;fontSize=11;" parent="1" source="pypAnUREyRbXbRG19NKG-6" target="pypAnUREyRbXbRG19NKG-8" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="pypAnUREyRbXbRG19NKG-10" value="否" style="edgeLabel;html=1;align=center;verticalAlign=middle;resizable=0;points=[];fontSize=11;" parent="pypAnUREyRbXbRG19NKG-9" vertex="1" connectable="0">
          <mxGeometry x="0.36" y="1" relative="1" as="geometry">
            <mxPoint x="-1" y="-7" as="offset" />
          </mxGeometry>
        </mxCell>
        <mxCell id="pypAnUREyRbXbRG19NKG-12" value="是" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;fontSize=11;" parent="1" source="pypAnUREyRbXbRG19NKG-6" target="pypAnUREyRbXbRG19NKG-11" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="pypAnUREyRbXbRG19NKG-6" value="&lt;font style=&quot;font-size: 11px&quot;&gt;是否已有重&lt;br&gt;分配任务&lt;/font&gt;" style="rhombus;whiteSpace=wrap;html=1;strokeWidth=2;" parent="1" vertex="1">
          <mxGeometry x="80" y="250" width="80" height="60" as="geometry" />
        </mxCell>
        <mxCell id="pypAnUREyRbXbRG19NKG-14" value="" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;fontSize=11;" parent="1" source="pypAnUREyRbXbRG19NKG-8" target="pypAnUREyRbXbRG19NKG-13" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="pypAnUREyRbXbRG19NKG-8" value="打印当前分区副本分配方式" style="whiteSpace=wrap;html=1;strokeWidth=2;fillColor=#0050ef;fontColor=#ffffff;strokeColor=#001DBC;" parent="1" vertex="1">
          <mxGeometry x="80" y="350" width="80" height="40" as="geometry" />
        </mxCell>
        <mxCell id="pypAnUREyRbXbRG19NKG-24" value="" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;fontSize=11;entryX=1;entryY=0.5;entryDx=0;entryDy=0;entryPerimeter=0;" parent="1" source="pypAnUREyRbXbRG19NKG-11" target="pypAnUREyRbXbRG19NKG-19" edge="1">
          <mxGeometry relative="1" as="geometry">
            <mxPoint x="160" y="530" as="targetPoint" />
            <Array as="points">
              <mxPoint x="220" y="690" />
            </Array>
          </mxGeometry>
        </mxCell>
        <mxCell id="pypAnUREyRbXbRG19NKG-11" value="更新zk中broker下的限流信息" style="whiteSpace=wrap;html=1;strokeWidth=2;fillColor=#0050ef;fontColor=#ffffff;strokeColor=#001DBC;" parent="1" vertex="1">
          <mxGeometry x="180" y="390" width="80" height="40" as="geometry" />
        </mxCell>
        <mxCell id="Vf_w9-UaPWHU4TDxyJZT-8" value="" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;fontSize=15;" parent="1" source="pypAnUREyRbXbRG19NKG-13" target="Vf_w9-UaPWHU4TDxyJZT-7" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="pypAnUREyRbXbRG19NKG-13" value="将针对Topic的限流写入zk中" style="whiteSpace=wrap;html=1;fillColor=#0050ef;strokeColor=#001DBC;fontColor=#ffffff;strokeWidth=2;" parent="1" vertex="1">
          <mxGeometry x="80" y="430" width="80" height="40" as="geometry" />
        </mxCell>
        <mxCell id="pypAnUREyRbXbRG19NKG-26" value="" style="swimlane;startSize=0;fontSize=11;fillColor=#007FFF;dashed=1;" parent="1" vertex="1">
          <mxGeometry x="20" y="150" width="250" height="620" as="geometry" />
        </mxCell>
        <mxCell id="pypAnUREyRbXbRG19NKG-29" value="&lt;font style=&quot;font-size: 15px&quot;&gt;客户端&lt;br&gt;（执行副本重分配脚本）&lt;/font&gt;" style="text;html=1;align=center;verticalAlign=middle;resizable=0;points=[];autosize=1;strokeColor=none;fillColor=none;fontSize=11;" parent="pypAnUREyRbXbRG19NKG-26" vertex="1">
          <mxGeometry x="35" y="570" width="180" height="40" as="geometry" />
        </mxCell>
        <mxCell id="pypAnUREyRbXbRG19NKG-19" value="结束" style="strokeWidth=2;html=1;shape=mxgraph.flowchart.terminator;whiteSpace=wrap;fillColor=#f8cecc;strokeColor=#b85450;" parent="pypAnUREyRbXbRG19NKG-26" vertex="1">
          <mxGeometry x="65" y="520" width="70" height="40" as="geometry" />
        </mxCell>
        <mxCell id="Vf_w9-UaPWHU4TDxyJZT-6" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;exitX=0.5;exitY=1;exitDx=0;exitDy=0;exitPerimeter=0;fontSize=15;" parent="pypAnUREyRbXbRG19NKG-26" source="pypAnUREyRbXbRG19NKG-19" target="pypAnUREyRbXbRG19NKG-19" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="Vf_w9-UaPWHU4TDxyJZT-7" value="将针对broker的限流写入zk中" style="whiteSpace=wrap;html=1;fillColor=#0050ef;strokeColor=#001DBC;fontColor=#ffffff;strokeWidth=2;" parent="pypAnUREyRbXbRG19NKG-26" vertex="1">
          <mxGeometry x="60" y="360" width="80" height="40" as="geometry" />
        </mxCell>
        <mxCell id="Vf_w9-UaPWHU4TDxyJZT-13" value="" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;fontSize=15;" parent="pypAnUREyRbXbRG19NKG-26" source="Vf_w9-UaPWHU4TDxyJZT-10" target="pypAnUREyRbXbRG19NKG-19" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="Vf_w9-UaPWHU4TDxyJZT-10" value="将分区重分配任务写到zk /admin/reassign_partitions节点" style="whiteSpace=wrap;html=1;fillColor=#0050ef;strokeColor=#001DBC;fontColor=#ffffff;strokeWidth=2;" parent="pypAnUREyRbXbRG19NKG-26" vertex="1">
          <mxGeometry x="27.5" y="420" width="145" height="50" as="geometry" />
        </mxCell>
        <mxCell id="Vf_w9-UaPWHU4TDxyJZT-11" value="" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;fontSize=15;" parent="pypAnUREyRbXbRG19NKG-26" source="Vf_w9-UaPWHU4TDxyJZT-7" target="Vf_w9-UaPWHU4TDxyJZT-10" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="N63IB5sTqFhrjtHg4DNX-46" value="" style="group" parent="1" vertex="1" connectable="0">
          <mxGeometry x="340" y="-150" width="620" height="1060" as="geometry" />
        </mxCell>
        <mxCell id="N63IB5sTqFhrjtHg4DNX-42" value="" style="group" parent="N63IB5sTqFhrjtHg4DNX-46" vertex="1" connectable="0">
          <mxGeometry x="21" y="20" width="289" height="980" as="geometry" />
        </mxCell>
        <mxCell id="Vf_w9-UaPWHU4TDxyJZT-5" value="从zk中读取副本重分配任务,针对每个分区逐个处理" style="whiteSpace=wrap;html=1;fillColor=#0050ef;strokeColor=#001DBC;strokeWidth=2;fontColor=#ffffff;container=0;" parent="N63IB5sTqFhrjtHg4DNX-42" vertex="1">
          <mxGeometry x="24.5" y="100" width="96" height="60" as="geometry" />
        </mxCell>
        <mxCell id="N63IB5sTqFhrjtHg4DNX-1" value="Topic是否等待被删除" style="rhombus;whiteSpace=wrap;html=1;fillColor=#0050ef;strokeColor=#001DBC;fontColor=#ffffff;strokeWidth=2;container=0;" parent="N63IB5sTqFhrjtHg4DNX-42" vertex="1">
          <mxGeometry x="12.5" y="190" width="120" height="80" as="geometry" />
        </mxCell>
        <mxCell id="N63IB5sTqFhrjtHg4DNX-2" value="" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;fontSize=15;" parent="N63IB5sTqFhrjtHg4DNX-42" source="Vf_w9-UaPWHU4TDxyJZT-5" target="N63IB5sTqFhrjtHg4DNX-1" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="N63IB5sTqFhrjtHg4DNX-3" value="标记该Topic不可被删除" style="whiteSpace=wrap;html=1;fillColor=#0050ef;strokeColor=#001DBC;fontColor=#ffffff;strokeWidth=2;container=0;" parent="N63IB5sTqFhrjtHg4DNX-42" vertex="1">
          <mxGeometry x="29.5" y="310" width="86" height="40" as="geometry" />
        </mxCell>
        <mxCell id="N63IB5sTqFhrjtHg4DNX-4" value="" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;fontSize=15;" parent="N63IB5sTqFhrjtHg4DNX-42" source="N63IB5sTqFhrjtHg4DNX-1" target="N63IB5sTqFhrjtHg4DNX-3" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="N63IB5sTqFhrjtHg4DNX-5" value="否" style="edgeLabel;html=1;align=center;verticalAlign=middle;resizable=0;points=[];fontSize=15;container=0;" parent="N63IB5sTqFhrjtHg4DNX-4" vertex="1" connectable="0">
          <mxGeometry x="-0.3333" y="1" relative="1" as="geometry">
            <mxPoint as="offset" />
          </mxGeometry>
        </mxCell>
        <mxCell id="vXaG2HQsSLzCo1a9P5aB-3" value="" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;" edge="1" parent="N63IB5sTqFhrjtHg4DNX-42" source="N63IB5sTqFhrjtHg4DNX-6" target="N63IB5sTqFhrjtHg4DNX-8">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="N63IB5sTqFhrjtHg4DNX-6" value="在zk和内存中更新最新的副本分配方式" style="whiteSpace=wrap;html=1;fillColor=#0050ef;strokeColor=#001DBC;fontColor=#ffffff;strokeWidth=2;container=0;" parent="N63IB5sTqFhrjtHg4DNX-42" vertex="1">
          <mxGeometry x="29.5" y="380" width="86" height="40" as="geometry" />
        </mxCell>
        <mxCell id="N63IB5sTqFhrjtHg4DNX-7" value="" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;fontSize=15;" parent="N63IB5sTqFhrjtHg4DNX-42" source="N63IB5sTqFhrjtHg4DNX-3" target="N63IB5sTqFhrjtHg4DNX-6" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="N63IB5sTqFhrjtHg4DNX-8" value="副本重分配是否已完成" style="rhombus;whiteSpace=wrap;html=1;fillColor=#0050ef;strokeColor=#001DBC;fontColor=#ffffff;strokeWidth=2;container=0;" parent="N63IB5sTqFhrjtHg4DNX-42" vertex="1">
          <mxGeometry x="7.5" y="470" width="130" height="80" as="geometry" />
        </mxCell>
        <mxCell id="N63IB5sTqFhrjtHg4DNX-16" value="修改内存中当前副本数据" style="whiteSpace=wrap;html=1;fillColor=#0050ef;strokeColor=#001DBC;fontColor=#ffffff;strokeWidth=2;container=0;" parent="N63IB5sTqFhrjtHg4DNX-42" vertex="1">
          <mxGeometry x="28.5" y="690" width="87" height="40" as="geometry" />
        </mxCell>
        <mxCell id="N63IB5sTqFhrjtHg4DNX-18" value="若原leader不在最终副本中，则须重新选举leader" style="whiteSpace=wrap;html=1;fillColor=#0050ef;strokeColor=#001DBC;fontColor=#ffffff;strokeWidth=2;container=0;" parent="N63IB5sTqFhrjtHg4DNX-42" vertex="1">
          <mxGeometry x="28.5" y="750" width="87" height="60" as="geometry" />
        </mxCell>
        <mxCell id="N63IB5sTqFhrjtHg4DNX-19" value="" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;fontSize=15;" parent="N63IB5sTqFhrjtHg4DNX-42" source="N63IB5sTqFhrjtHg4DNX-16" target="N63IB5sTqFhrjtHg4DNX-18" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="N63IB5sTqFhrjtHg4DNX-21" value="将需要删除的副本下线并删除" style="whiteSpace=wrap;html=1;fillColor=#0050ef;strokeColor=#001DBC;fontColor=#ffffff;strokeWidth=2;container=0;" parent="N63IB5sTqFhrjtHg4DNX-42" vertex="1">
          <mxGeometry x="28.5" y="830" width="87" height="40" as="geometry" />
        </mxCell>
        <mxCell id="N63IB5sTqFhrjtHg4DNX-22" value="" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;fontSize=15;" parent="N63IB5sTqFhrjtHg4DNX-42" source="N63IB5sTqFhrjtHg4DNX-18" target="N63IB5sTqFhrjtHg4DNX-21" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="N63IB5sTqFhrjtHg4DNX-23" value="更新zk中的副本信息和broker元数据" style="whiteSpace=wrap;html=1;fillColor=#0050ef;strokeColor=#001DBC;fontColor=#ffffff;strokeWidth=2;container=0;" parent="N63IB5sTqFhrjtHg4DNX-42" vertex="1">
          <mxGeometry x="28.5" y="890" width="87" height="40" as="geometry" />
        </mxCell>
        <mxCell id="N63IB5sTqFhrjtHg4DNX-24" value="" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;fontSize=15;" parent="N63IB5sTqFhrjtHg4DNX-42" source="N63IB5sTqFhrjtHg4DNX-21" target="N63IB5sTqFhrjtHg4DNX-23" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="N63IB5sTqFhrjtHg4DNX-25" value="释放对Topic的标记" style="whiteSpace=wrap;html=1;fillColor=#0050ef;strokeColor=#001DBC;fontColor=#ffffff;strokeWidth=2;container=0;" parent="N63IB5sTqFhrjtHg4DNX-42" vertex="1">
          <mxGeometry x="28.5" y="950" width="87" height="40" as="geometry" />
        </mxCell>
        <mxCell id="N63IB5sTqFhrjtHg4DNX-26" value="" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;fontSize=15;" parent="N63IB5sTqFhrjtHg4DNX-42" source="N63IB5sTqFhrjtHg4DNX-23" target="N63IB5sTqFhrjtHg4DNX-25" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="N63IB5sTqFhrjtHg4DNX-27" value="结束" style="strokeWidth=2;html=1;shape=mxgraph.flowchart.terminator;whiteSpace=wrap;fillColor=#f8cecc;strokeColor=#b85450;container=0;" parent="N63IB5sTqFhrjtHg4DNX-42" vertex="1">
          <mxGeometry x="161" y="950" width="70" height="40" as="geometry" />
        </mxCell>
        <mxCell id="N63IB5sTqFhrjtHg4DNX-38" value="" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;fontSize=15;entryX=1;entryY=0.5;entryDx=0;entryDy=0;entryPerimeter=0;" parent="N63IB5sTqFhrjtHg4DNX-42" source="N63IB5sTqFhrjtHg4DNX-1" target="N63IB5sTqFhrjtHg4DNX-27" edge="1">
          <mxGeometry relative="1" as="geometry">
            <mxPoint x="258.5" y="960" as="targetPoint" />
            <Array as="points">
              <mxPoint x="258.5" y="230" />
              <mxPoint x="258.5" y="960" />
            </Array>
          </mxGeometry>
        </mxCell>
        <mxCell id="N63IB5sTqFhrjtHg4DNX-48" value="是" style="edgeLabel;html=1;align=center;verticalAlign=middle;resizable=0;points=[];fontSize=15;" parent="N63IB5sTqFhrjtHg4DNX-38" vertex="1" connectable="0">
          <mxGeometry x="-0.5925" y="2" relative="1" as="geometry">
            <mxPoint x="-2" as="offset" />
          </mxGeometry>
        </mxCell>
        <mxCell id="N63IB5sTqFhrjtHg4DNX-30" value="" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;fontSize=15;" parent="N63IB5sTqFhrjtHg4DNX-42" source="N63IB5sTqFhrjtHg4DNX-25" target="N63IB5sTqFhrjtHg4DNX-27" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="N63IB5sTqFhrjtHg4DNX-31" value="给RS中副本所在broker发送LeaderAndIsr请求" style="whiteSpace=wrap;html=1;fillColor=#0050ef;strokeColor=#001DBC;fontColor=#ffffff;strokeWidth=2;container=0;" parent="N63IB5sTqFhrjtHg4DNX-42" vertex="1">
          <mxGeometry x="148.5" y="715" width="95" height="55" as="geometry" />
        </mxCell>
        <mxCell id="N63IB5sTqFhrjtHg4DNX-32" value="" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;fontSize=15;" parent="N63IB5sTqFhrjtHg4DNX-42" source="N63IB5sTqFhrjtHg4DNX-8" target="N63IB5sTqFhrjtHg4DNX-31" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="N63IB5sTqFhrjtHg4DNX-33" value="否" style="edgeLabel;html=1;align=center;verticalAlign=middle;resizable=0;points=[];fontSize=15;container=0;" parent="N63IB5sTqFhrjtHg4DNX-32" vertex="1" connectable="0">
          <mxGeometry x="0.298" y="3" relative="1" as="geometry">
            <mxPoint x="-3" as="offset" />
          </mxGeometry>
        </mxCell>
        <mxCell id="N63IB5sTqFhrjtHg4DNX-37" value="" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;fontSize=15;entryX=0.5;entryY=0;entryDx=0;entryDy=0;entryPerimeter=0;" parent="N63IB5sTqFhrjtHg4DNX-42" source="N63IB5sTqFhrjtHg4DNX-34" target="N63IB5sTqFhrjtHg4DNX-27" edge="1">
          <mxGeometry relative="1" as="geometry">
            <mxPoint x="196" y="790" as="targetPoint" />
          </mxGeometry>
        </mxCell>
        <mxCell id="N63IB5sTqFhrjtHg4DNX-34" value="副本状态机将AR中所有副本置为NewReplica状态" style="whiteSpace=wrap;html=1;fillColor=#0050ef;strokeColor=#001DBC;fontColor=#ffffff;strokeWidth=2;container=0;" parent="N63IB5sTqFhrjtHg4DNX-42" vertex="1">
          <mxGeometry x="148.5" y="800" width="95" height="55" as="geometry" />
        </mxCell>
        <mxCell id="N63IB5sTqFhrjtHg4DNX-35" value="" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;fontSize=15;" parent="N63IB5sTqFhrjtHg4DNX-42" source="N63IB5sTqFhrjtHg4DNX-31" target="N63IB5sTqFhrjtHg4DNX-34" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="vXaG2HQsSLzCo1a9P5aB-1" value="" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;" edge="1" parent="N63IB5sTqFhrjtHg4DNX-42" source="N63IB5sTqFhrjtHg4DNX-120" target="Vf_w9-UaPWHU4TDxyJZT-5">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="N63IB5sTqFhrjtHg4DNX-120" value="Controller监听到&lt;br&gt;/admin/reassign_partitions变化" style="strokeWidth=2;html=1;shape=mxgraph.flowchart.terminator;whiteSpace=wrap;fillColor=#f8cecc;strokeColor=#b85450;" parent="N63IB5sTqFhrjtHg4DNX-42" vertex="1">
          <mxGeometry x="1.8699999999999999" y="10" width="141.25" height="50" as="geometry" />
        </mxCell>
        <mxCell id="N63IB5sTqFhrjtHg4DNX-134" value="结束" style="strokeWidth=2;html=1;shape=mxgraph.flowchart.terminator;whiteSpace=wrap;fillColor=#f8cecc;strokeColor=#b85450;" parent="N63IB5sTqFhrjtHg4DNX-42" vertex="1">
          <mxGeometry x="243.5" y="120" width="70" height="40" as="geometry" />
        </mxCell>
        <mxCell id="vXaG2HQsSLzCo1a9P5aB-30" value="1" style="ellipse;whiteSpace=wrap;html=1;aspect=fixed;" vertex="1" parent="N63IB5sTqFhrjtHg4DNX-42">
          <mxGeometry x="57.5" y="430" width="30" height="30" as="geometry" />
        </mxCell>
        <mxCell id="vXaG2HQsSLzCo1a9P5aB-31" value="2" style="ellipse;whiteSpace=wrap;html=1;aspect=fixed;" vertex="1" parent="N63IB5sTqFhrjtHg4DNX-42">
          <mxGeometry x="181" y="520" width="30" height="30" as="geometry" />
        </mxCell>
        <mxCell id="N63IB5sTqFhrjtHg4DNX-10" value="副本状态机将新增副本置为上线状态" style="whiteSpace=wrap;html=1;fillColor=#0050ef;strokeColor=#001DBC;fontColor=#ffffff;strokeWidth=2;container=0;" parent="N63IB5sTqFhrjtHg4DNX-42" vertex="1">
          <mxGeometry x="28.5" y="630" width="87" height="40" as="geometry" />
        </mxCell>
        <mxCell id="N63IB5sTqFhrjtHg4DNX-17" value="" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;fontSize=15;" parent="N63IB5sTqFhrjtHg4DNX-42" source="N63IB5sTqFhrjtHg4DNX-10" target="N63IB5sTqFhrjtHg4DNX-16" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="N63IB5sTqFhrjtHg4DNX-11" value="" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;fontSize=15;" parent="N63IB5sTqFhrjtHg4DNX-42" source="N63IB5sTqFhrjtHg4DNX-8" target="N63IB5sTqFhrjtHg4DNX-10" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="vXaG2HQsSLzCo1a9P5aB-18" value="是" style="edgeLabel;html=1;align=center;verticalAlign=middle;resizable=0;points=[];" vertex="1" connectable="0" parent="N63IB5sTqFhrjtHg4DNX-11">
          <mxGeometry x="0.2" relative="1" as="geometry">
            <mxPoint y="13" as="offset" />
          </mxGeometry>
        </mxCell>
        <mxCell id="vXaG2HQsSLzCo1a9P5aB-42" value="5" style="ellipse;whiteSpace=wrap;html=1;aspect=fixed;" vertex="1" parent="N63IB5sTqFhrjtHg4DNX-42">
          <mxGeometry x="57" y="560" width="30" height="30" as="geometry" />
        </mxCell>
        <mxCell id="N63IB5sTqFhrjtHg4DNX-43" value="" style="swimlane;startSize=0;dashed=1;fontSize=15;fillColor=#007FFF;" parent="N63IB5sTqFhrjtHg4DNX-46" vertex="1">
          <mxGeometry width="560" height="1060" as="geometry" />
        </mxCell>
        <mxCell id="N63IB5sTqFhrjtHg4DNX-125" value="" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;fontSize=15;" parent="N63IB5sTqFhrjtHg4DNX-43" source="N63IB5sTqFhrjtHg4DNX-121" edge="1">
          <mxGeometry relative="1" as="geometry">
            <mxPoint x="445" y="120" as="targetPoint" />
          </mxGeometry>
        </mxCell>
        <mxCell id="N63IB5sTqFhrjtHg4DNX-121" value="Controller监听到&lt;br&gt;/brokers/topics/{topicName}&lt;br&gt;/partitions/{分区号}/state变化" style="strokeWidth=2;html=1;shape=mxgraph.flowchart.terminator;whiteSpace=wrap;fillColor=#f8cecc;strokeColor=#b85450;" parent="N63IB5sTqFhrjtHg4DNX-43" vertex="1">
          <mxGeometry x="370" y="30" width="150" height="60" as="geometry" />
        </mxCell>
        <mxCell id="N63IB5sTqFhrjtHg4DNX-133" value="" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;fontSize=15;" parent="N63IB5sTqFhrjtHg4DNX-43" source="N63IB5sTqFhrjtHg4DNX-126" edge="1">
          <mxGeometry relative="1" as="geometry">
            <mxPoint x="137" y="350" as="targetPoint" />
            <Array as="points">
              <mxPoint x="445" y="350" />
              <mxPoint x="137" y="350" />
            </Array>
          </mxGeometry>
        </mxCell>
        <mxCell id="N63IB5sTqFhrjtHg4DNX-135" value="是" style="edgeLabel;html=1;align=center;verticalAlign=middle;resizable=0;points=[];fontSize=15;" parent="N63IB5sTqFhrjtHg4DNX-133" vertex="1" connectable="0">
          <mxGeometry x="-0.2889" relative="1" as="geometry">
            <mxPoint as="offset" />
          </mxGeometry>
        </mxCell>
        <mxCell id="N63IB5sTqFhrjtHg4DNX-126" value="副本重分配是否已完成" style="rhombus;whiteSpace=wrap;html=1;fillColor=#0050ef;strokeColor=#001DBC;fontColor=#ffffff;strokeWidth=2;container=0;" parent="N63IB5sTqFhrjtHg4DNX-43" vertex="1">
          <mxGeometry x="380" y="120" width="130" height="80" as="geometry" />
        </mxCell>
        <mxCell id="N63IB5sTqFhrjtHg4DNX-44" value="Controller节点&lt;br&gt;（副本重分配逻辑处理）" style="text;html=1;align=center;verticalAlign=middle;resizable=0;points=[];autosize=1;strokeColor=none;fillColor=none;fontSize=15;" parent="N63IB5sTqFhrjtHg4DNX-43" vertex="1">
          <mxGeometry x="195" y="1010" width="180" height="40" as="geometry" />
        </mxCell>
        <mxCell id="vXaG2HQsSLzCo1a9P5aB-37" value="4" style="ellipse;whiteSpace=wrap;html=1;aspect=fixed;" vertex="1" parent="N63IB5sTqFhrjtHg4DNX-43">
          <mxGeometry x="430" y="240" width="30" height="30" as="geometry" />
        </mxCell>
        <mxCell id="vXaG2HQsSLzCo1a9P5aB-21" value="" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;" edge="1" parent="N63IB5sTqFhrjtHg4DNX-46" source="N63IB5sTqFhrjtHg4DNX-126" target="N63IB5sTqFhrjtHg4DNX-134">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="vXaG2HQsSLzCo1a9P5aB-22" value="否" style="edgeLabel;html=1;align=center;verticalAlign=middle;resizable=0;points=[];" vertex="1" connectable="0" parent="vXaG2HQsSLzCo1a9P5aB-21">
          <mxGeometry x="-0.033" relative="1" as="geometry">
            <mxPoint as="offset" />
          </mxGeometry>
        </mxCell>
        <mxCell id="N63IB5sTqFhrjtHg4DNX-47" value="" style="endArrow=classic;html=1;rounded=0;fontSize=15;exitX=1.012;exitY=0.044;exitDx=0;exitDy=0;exitPerimeter=0;entryX=-0.007;entryY=0.107;entryDx=0;entryDy=0;entryPerimeter=0;" parent="1" source="pypAnUREyRbXbRG19NKG-26" target="N63IB5sTqFhrjtHg4DNX-43" edge="1">
          <mxGeometry width="50" height="50" relative="1" as="geometry">
            <mxPoint x="320" y="220" as="sourcePoint" />
            <mxPoint x="370" y="170" as="targetPoint" />
            <Array as="points">
              <mxPoint x="300" y="177" />
              <mxPoint x="300" y="-37" />
            </Array>
          </mxGeometry>
        </mxCell>
        <mxCell id="zOlwQTdn3VEQp71eWbMR-3" value="" style="group" parent="1" vertex="1" connectable="0">
          <mxGeometry x="1017.5" y="40" width="152.5" height="690" as="geometry" />
        </mxCell>
        <mxCell id="vXaG2HQsSLzCo1a9P5aB-29" value="" style="group" vertex="1" connectable="0" parent="zOlwQTdn3VEQp71eWbMR-3">
          <mxGeometry x="-47.5" y="300" width="200" height="490" as="geometry" />
        </mxCell>
        <mxCell id="N63IB5sTqFhrjtHg4DNX-136" value="校验request及broker的epoch" style="whiteSpace=wrap;html=1;fillColor=#0050ef;strokeColor=#001DBC;strokeWidth=2;fontColor=#ffffff;container=0;" parent="vXaG2HQsSLzCo1a9P5aB-29" vertex="1">
          <mxGeometry x="60" y="43" width="90" height="40" as="geometry" />
        </mxCell>
        <mxCell id="N63IB5sTqFhrjtHg4DNX-137" value="调用makeFollowers方法本地创建副本文件" style="whiteSpace=wrap;html=1;fillColor=#0050ef;strokeColor=#001DBC;fontColor=#ffffff;strokeWidth=2;container=0;" parent="vXaG2HQsSLzCo1a9P5aB-29" vertex="1">
          <mxGeometry x="47.5" y="123" width="115" height="50" as="geometry" />
        </mxCell>
        <mxCell id="N63IB5sTqFhrjtHg4DNX-138" value="" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;fontSize=15;" parent="vXaG2HQsSLzCo1a9P5aB-29" source="N63IB5sTqFhrjtHg4DNX-136" target="N63IB5sTqFhrjtHg4DNX-137" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="zOlwQTdn3VEQp71eWbMR-1" value="启用新线程发送FetchRequest与leader通信拉取数据" style="whiteSpace=wrap;html=1;fillColor=#0050ef;strokeColor=#001DBC;fontColor=#ffffff;strokeWidth=2;container=0;" parent="vXaG2HQsSLzCo1a9P5aB-29" vertex="1">
          <mxGeometry x="47.5" y="213" width="115" height="50" as="geometry" />
        </mxCell>
        <mxCell id="zOlwQTdn3VEQp71eWbMR-2" value="" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;" parent="vXaG2HQsSLzCo1a9P5aB-29" source="N63IB5sTqFhrjtHg4DNX-137" target="zOlwQTdn3VEQp71eWbMR-1" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="zOlwQTdn3VEQp71eWbMR-6" value="" style="swimlane;startSize=0;dashed=1;container=0;" parent="vXaG2HQsSLzCo1a9P5aB-29" vertex="1">
          <mxGeometry width="200" height="490" as="geometry" />
        </mxCell>
        <mxCell id="zOlwQTdn3VEQp71eWbMR-16" value="" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;" parent="vXaG2HQsSLzCo1a9P5aB-29" source="zOlwQTdn3VEQp71eWbMR-1" target="zOlwQTdn3VEQp71eWbMR-15" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="zOlwQTdn3VEQp71eWbMR-7" value="Broker节点&lt;br&gt;（接受LeaderAndIsr请求并进行&lt;br&gt;相应处理）" style="text;html=1;align=center;verticalAlign=middle;resizable=0;points=[];autosize=1;strokeColor=none;fillColor=none;container=0;" parent="vXaG2HQsSLzCo1a9P5aB-29" vertex="1">
          <mxGeometry x="10" y="430" width="180" height="50" as="geometry" />
        </mxCell>
        <mxCell id="zOlwQTdn3VEQp71eWbMR-15" value="处理FetchResponse，更新hw" style="whiteSpace=wrap;html=1;fillColor=#0050ef;strokeColor=#001DBC;fontColor=#ffffff;strokeWidth=2;container=0;" parent="vXaG2HQsSLzCo1a9P5aB-29" vertex="1">
          <mxGeometry x="47.5" y="290" width="115" height="50" as="geometry" />
        </mxCell>
        <mxCell id="zOlwQTdn3VEQp71eWbMR-17" value="结束" style="strokeWidth=2;html=1;shape=mxgraph.flowchart.terminator;whiteSpace=wrap;fillColor=#f8cecc;strokeColor=#b85450;container=0;" parent="vXaG2HQsSLzCo1a9P5aB-29" vertex="1">
          <mxGeometry x="70" y="370" width="70" height="40" as="geometry" />
        </mxCell>
        <mxCell id="zOlwQTdn3VEQp71eWbMR-18" value="" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;" parent="vXaG2HQsSLzCo1a9P5aB-29" source="zOlwQTdn3VEQp71eWbMR-15" target="zOlwQTdn3VEQp71eWbMR-17" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="vXaG2HQsSLzCo1a9P5aB-27" value="" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;entryX=-0.02;entryY=0.555;entryDx=0;entryDy=0;entryPerimeter=0;startArrow=none;" edge="1" parent="1" source="vXaG2HQsSLzCo1a9P5aB-35" target="zOlwQTdn3VEQp71eWbMR-6">
          <mxGeometry relative="1" as="geometry">
            <mxPoint x="960" y="613" as="targetPoint" />
            <Array as="points">
              <mxPoint x="960" y="613" />
            </Array>
          </mxGeometry>
        </mxCell>
        <mxCell id="vXaG2HQsSLzCo1a9P5aB-35" value="3" style="ellipse;whiteSpace=wrap;html=1;aspect=fixed;" vertex="1" parent="1">
          <mxGeometry x="715" y="595" width="30" height="30" as="geometry" />
        </mxCell>
        <mxCell id="vXaG2HQsSLzCo1a9P5aB-36" value="" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;entryX=-0.02;entryY=0.555;entryDx=0;entryDy=0;entryPerimeter=0;endArrow=none;" edge="1" parent="1" source="N63IB5sTqFhrjtHg4DNX-31" target="vXaG2HQsSLzCo1a9P5aB-35">
          <mxGeometry relative="1" as="geometry">
            <mxPoint x="966" y="611.9499999999998" as="targetPoint" />
            <mxPoint x="604.5" y="612" as="sourcePoint" />
            <Array as="points" />
          </mxGeometry>
        </mxCell>
      </root>
    </mxGraphModel>
  </diagram>
</mxfile>
